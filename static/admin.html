<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–∞–Ω–µ–ª—å –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –ñ–ö–•</title>
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª —Å—Ç–∏–ª–µ–π (–≤–Ω—É—Ç—Ä–∏ @import –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π) -->
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="container">
        <!-- HEADER -->
        <header>
            <div class="header-user-info">
                <h1>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ñ–ö–•</h1>
            </div>
            <div class="header-user-info">
                <span id="adminName" style="font-weight: 600; color: #555;"></span>
                <!-- –£–±—Ä–∞–ª onclick, JS —Å–∞–º –Ω–∞–π–¥–µ—Ç –∫–Ω–æ–ø–∫—É –ø–æ –∫–ª–∞—Å—Å—É -->
                <button class="logout-btn">–í—ã–π—Ç–∏</button>
            </div>
        </header>

        <!-- NAV TABS -->
        <div class="tabs">
            <button class="tab-btn active" data-tab="readings">üîç –°–≤–µ—Ä–∫–∞</button>
            <button class="tab-btn" data-tab="users">üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</button>
            <button class="tab-btn" data-tab="tariffs">‚öôÔ∏è –¢–∞—Ä–∏—Ñ—ã</button>
            <button class="tab-btn" data-tab="accountant">üìä –°–≤–æ–¥–∫–∞</button>
        </div>

        <!-- TAB 1: –°–í–ï–†–ö–ê –ü–û–ö–ê–ó–ê–ù–ò–ô -->
        <div id="readings" class="tab-content active">
            <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–æ–º -->
            <div class="card" style="background: linear-gradient(to right, #f8f9fa, #e9ecef); border: 1px solid #dee2e6;">
                <!-- –ë–ª–æ–∫: –ü–µ—Ä–∏–æ–¥ –æ—Ç–∫—Ä—ã—Ç -->
                <div id="periodActiveState" style="display:none; justify-content:space-between; align-items:center; flex-wrap: wrap; gap: 15px;">
                    <div>
                        <h2 style="margin:0; border:none; color:#333; font-size: 18px;">
                            üü¢ –û—Ç–∫—Ä—ã—Ç —Å–±–æ—Ä: <span id="activePeriodLabel" style="color:#27ae60; font-weight:bold;"></span>
                        </h2>
                        <small style="color:#666;">–ñ–∏–ª—å—Ü—ã –º–æ–≥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ.</small>
                    </div>
                    <button class="action-btn" style="background:#c0392b;">üîí –ó–∞–∫—Ä—ã—Ç—å –º–µ—Å—è—Ü</button>
                </div>

                <!-- –ë–ª–æ–∫: –ü–µ—Ä–∏–æ–¥ –∑–∞–∫—Ä—ã—Ç -->
                <div id="periodClosedState" style="display:none; justify-content:space-between; align-items:center; flex-wrap: wrap; gap: 15px;">
                    <div>
                        <h2 style="margin:0; border:none; color:#555; font-size: 18px;">üî¥ –ü—Ä–∏–µ–º –∑–∞–∫—Ä—ã—Ç</h2>
                        <small style="color:#666;">–ù–∞—á–Ω–∏—Ç–µ –Ω–æ–≤—ã–π –º–µ—Å—è—Ü.</small>
                    </div>
                    <div style="display:flex; gap:10px; align-items: center;">
                        <input type="text" id="newPeriodNameInput" placeholder="–ù–∞–ø—Ä. –ú–∞–π 2025" style="width: 200px;">
                        <button class="action-btn" style="background:#27ae60;">üìÇ –û—Ç–∫—Ä—ã—Ç—å –Ω–æ–≤—ã–π</button>
                    </div>
                </div>
            </div>

            <!-- –¢–∞–±–ª–∏—Ü–∞ -->
            <div class="card">
                <div class="controls-header">
                    <h2>–ü–æ—Å—Ç—É–ø–∏–≤—à–∏–µ –ø–æ–∫–∞–∑–∞–Ω–∏—è</h2>
                    <div class="controls-group">
                        <button id="btnBulkApprove" class="action-btn" style="background:#f39c12; font-size: 13px;">‚ö° –£—Ç–≤–µ—Ä–¥–∏—Ç—å –≤—Å–µ (–ê–≤—Ç–æ)</button>
                        <button id="btnRefreshReadings" class="refresh-btn">‚Üª</button>
                    </div>
                </div>

                <div style="margin-bottom: 15px; padding: 10px; background: #fff3cd; border-radius: 6px; border: 1px solid #ffeeba;">
                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-weight: 600; color: #856404;">
                        <input type="checkbox" id="filterAnomalies"> –¢–æ–ª—å–∫–æ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–∫–∞–∑–∞–Ω–∏—è
                    </label>
                </div>

                <div class="pagination" style="display: flex; gap: 10px; margin-bottom: 15px; align-items: center;">
                    <button id="btnPrev" class="action-btn" style="padding: 5px 10px; background: #bdc3c7;">‚Üê</button>
                    <span id="pageIndicator" style="font-weight: bold; min-width: 60px; text-align: center;">–°—Ç—Ä. 1</span>
                    <button id="btnNext" class="action-btn" style="padding: 5px 10px; background: #bdc3c7;">‚Üí</button>
                </div>

                <div class="table-container">
                    <table id="readingsTable">
                        <thead>
                            <tr>
                                <th>–ñ–∏–ª–µ—Ü</th><th>–°—Ç–∞—Ç—É—Å</th><th>–ì.–í–æ–¥–∞</th><th>–•.–í–æ–¥–∞</th><th>–°–≤–µ—Ç</th><th>–°—É–º–º–∞</th><th>–î–µ–π—Å—Ç–≤–∏–µ</th>
                            </tr>
                        </thead>
                        <tbody id="readingsTableBody"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- TAB 2: –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ò -->
        <div id="users" class="tab-content">
            <div class="card" style="border-left: 5px solid #2ecc71;">
                <h2>üìÅ –ú–∞—Å—Å–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (Excel)</h2>
                <div style="display:flex; gap:10px; align-items:center;">
                    <input type="file" id="importUsersFile" accept=".xlsx" style="padding:5px;">
                    <!-- –£–±—Ä–∞–ª onclick, –¥–æ–±–∞–≤–∏–ª ID –¥–ª—è JS -->
                    <button id="btnImportUsers" class="action-btn">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
                </div>
            </div>

            <div class="card">
                <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –∂–∏–ª—å—Ü–∞</h2>
                <form id="addUserForm">
                    <div class="form-grid">
                        <div class="form-group"><label>–õ–æ–≥–∏–Ω</label><input type="text" id="newUsername" required></div>
                        <div class="form-group"><label>–ü–∞—Ä–æ–ª—å</label><input type="password" id="newPassword" required></div>
                        <div class="form-group"><label>–†–æ–ª—å</label><select id="newRole"><option value="user">–ñ–∏–ª–µ—Ü</option><option value="accountant">–ë—É—Ö–≥–∞–ª—Ç–µ—Ä</option><option value="financier">–§–∏–Ω–∞–Ω—Å–∏—Å—Ç</option></select></div>
                        <div class="form-group"><label>–û–±—â–µ–∂–∏—Ç–∏–µ</label><input type="text" id="dormitory"></div>
                        <div class="form-group"><label>–ü–ª–æ—â–∞–¥—å (–º¬≤)</label><input type="number" step="0.1" id="area" value="0"></div>
                        <div class="form-group"><label>–ü–ª–∞—Ç–∏—Ç –∑–∞ (—á–µ–ª)</label><input type="number" id="residentsCount" value="1"></div>
                        <div class="form-group"><label>–í—Å–µ–≥–æ –≤ –∫–æ–º–Ω–∞—Ç–µ</label><input type="number" id="totalRoomResidents" value="1"></div>
                        <div class="form-group full-width"><label>–ú–µ—Å—Ç–æ —Ä–∞–±–æ—Ç—ã</label><input type="text" id="workplace"></div>
                    </div>
                    <button type="submit" class="action-btn" style="margin-top: 20px;">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å</button>
                </form>
            </div>

            <div class="card">
                <div class="controls-header">
                    <h2>–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h2>
                    <button id="btnRefreshUsers" class="refresh-btn">‚Üª –û–±–Ω–æ–≤–∏—Ç—å</button>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr><th>ID</th><th>–õ–æ–≥–∏–Ω</th><th>–†–æ–ª—å</th><th>–û–±—â.</th><th>–ü–ª–æ—â.</th><th>–î–æ–ª—è</th><th>–†–∞–±–æ—Ç–∞</th><th>–î–µ–π—Å—Ç–≤–∏—è</th></tr>
                        </thead>
                        <tbody id="usersTableBody"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- TAB 3: –¢–ê–†–ò–§–´ -->
        <div id="tariffs" class="tab-content">
            <div class="card">
                <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–∞—Ä–∏—Ñ–æ–≤ (—Ä—É–±.)</h2>
                <form id="tariffsForm">
                    <div class="tariffs-grid">
                        <div class="tariff-item"><label>–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –∏ —Ä–µ–º–æ–Ω—Ç</label><input type="number" step="0.01" id="t_main" required></div>
                        <div class="tariff-item"><label>–ù–∞–µ–º –∂–∏–ª—å—è</label><input type="number" step="0.01" id="t_rent" required></div>
                        <div class="tariff-item"><label>–¢–ö–û (–ú—É—Å–æ—Ä)</label><input type="number" step="0.01" id="t_waste" required></div>
                        <div class="tariff-item"><label>–û—Ç–æ–ø–ª–µ–Ω–∏–µ</label><input type="number" step="0.01" id="t_heat" required></div>
                        <div class="tariff-item"><label>–ü–æ–¥–æ–≥—Ä–µ–≤ –ì–í–°</label><input type="number" step="0.01" id="t_w_heat" required></div>
                        <div class="tariff-item"><label>–ü–æ–¥–∞—á–∞ –≤–æ–¥—ã</label><input type="number" step="0.01" id="t_w_sup" required></div>
                        <div class="tariff-item"><label>–í–æ–¥–æ–æ—Ç–≤–µ–¥–µ–Ω–∏–µ</label><input type="number" step="0.01" id="t_sew" required></div>
                        <div class="tariff-item"><label>–≠–ª. –≠–Ω–µ—Ä–≥–∏—è (—Ç–∞—Ä–∏—Ñ)</label><input type="number" step="0.01" id="t_el_rate" required></div>
                        <div class="tariff-item"><label>–≠–ª. —ç–Ω–µ—Ä–≥–∏—è (–û–î–ù)</label><input type="number" step="0.01" id="t_el_sqm" required></div>
                    </div>
                    <button type="submit" class="action-btn" style="background-color: #27ae60; margin-top: 30px;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–∞—Ä–∏—Ñ—ã</button>
                </form>
            </div>
        </div>

        <!-- TAB 4: –°–í–û–î–ö–ê -->
        <div id="accountant" class="tab-content">
            <div class="card">
                <div class="controls-header">
                    <h2>–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è —Å–≤–æ–¥–∫–∞</h2>
                    <div class="controls-group">
                        <div id="summaryPeriodSelector"></div>
                        <button id="btnDownloadZip" class="action-btn" style="background:#3498db;">üóÇ ZIP</button>
                        <button id="btnDownloadExcel" class="action-btn" style="background:#27ae60;">üìä Excel</button>
                        <button id="btnRefreshSummary" class="refresh-btn">‚Üª</button>
                    </div>
                </div>
                <div id="summaryContainer"></div>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê (–°–ª–æ–∂–Ω—ã–µ —Ñ–æ—Ä–º—ã) -->

    <!-- –ú–æ–¥–∞–ª–∫–∞: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –ö–æ—Ä—Ä–µ–∫—Ü–∏—è -->
    <div id="approveModal" class="modal-overlay">
        <div class="modal-window">
            <div class="modal-header">–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∫–∞–∑–∞–Ω–∏–π</div>
            <input type="hidden" id="modal_reading_id">

            <div style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin-bottom: 20px; font-size: 14px; border-left: 4px solid #4a90e2;">
                <strong>–ñ–∏–ª–µ—Ü:</strong> <span id="m_username"></span><br>
                –ì–í–° (—Ä–∞—Å—Ö–æ–¥): <span id="m_hot_usage"></span> –º¬≥<br>
                –•–í–° (—Ä–∞—Å—Ö–æ–¥): <span id="m_cold_usage"></span> –º¬≥<br>
                –°–≤–µ—Ç (—Ä–∞—Å—Ö–æ–¥): <span id="m_elect_usage"></span> –∫–í—Ç
            </div>

            <div style="display: grid; gap: 10px;">
                <div class="modal-row"><label>–ö–æ—Ä—Ä. –ì–í–°:</label><input type="number" step="0.001" id="m_corr_hot"></div>
                <div class="modal-row"><label>–ö–æ—Ä—Ä. –•–í–°:</label><input type="number" step="0.001" id="m_corr_cold"></div>
                <div class="modal-row"><label>–ö–æ—Ä—Ä. –°–≤–µ—Ç:</label><input type="number" step="0.001" id="m_corr_elect"></div>
                <div class="modal-row"><label>–ö–æ—Ä—Ä. –í–æ–¥–æ–æ—Ç–≤.:</label><input type="number" step="0.001" id="m_corr_sewage"></div>
            </div>

            <div class="modal-actions">
                <button id="btnModalClose" class="close-btn">–û—Ç–º–µ–Ω–∞</button>
                <button id="btnModalSubmit" class="confirm-btn">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª–∫–∞: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
    <div id="userEditModal" class="modal-overlay">
        <div class="modal-window">
            <div class="modal-header">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</div>
            <form id="editUserForm">
                <input type="hidden" id="editUserId">
                <div class="form-grid">
                    <div class="form-group"><label>–õ–æ–≥–∏–Ω</label><input type="text" id="editUsername" required></div>
                    <div class="form-group"><label>–ü–∞—Ä–æ–ª—å</label><input type="text" id="editPassword" placeholder="–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)"></div>
                    <div class="form-group"><label>–†–æ–ª—å</label><select id="editRole"><option value="user">–ñ–∏–ª–µ—Ü</option><option value="accountant">–ë—É—Ö–≥–∞–ª—Ç–µ—Ä</option><option value="financier">–§–∏–Ω–∞–Ω—Å–∏—Å—Ç</option></select></div>
                    <div class="form-group"><label>–û–±—â–µ–∂–∏—Ç–∏–µ</label><input type="text" id="editDormitory"></div>
                    <div class="form-group"><label>–ü–ª–æ—â–∞–¥—å</label><input type="number" step="0.1" id="editArea"></div>
                    <div class="form-group"><label>–ñ–∏–ª—å—Ü–æ–≤</label><input type="number" id="editResidentsCount"></div>
                    <div class="form-group"><label>–í—Å–µ–≥–æ –º–µ—Å—Ç</label><input type="number" id="editTotalRoomResidents"></div>
                    <div class="form-group"><label>–†–∞–±–æ—Ç–∞</label><input type="text" id="editWorkplace"></div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="close-btn">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="confirm-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </form>
        </div>
    </div>

    <script type="module" src="js/app.js"></script>
</body>
</html>