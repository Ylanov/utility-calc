<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–†–∞–±–æ—á–µ–µ –º–µ—Å—Ç–æ –§–∏–Ω–∞–Ω—Å–∏—Å—Ç–∞</title>
<link rel="stylesheet" href="style.css">
<style>
/* –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ */
.upload-area {
    display: flex;
    flex-direction: column;
    gap: 15px;
    background: #f9f9f9;
    padding: 20px;
    border-radius: 8px;
    border: 1px dashed #ccc;
}
.upload-row {
    display: flex;
    gap: 15px;
    align-items: center;
    width: 100%;
}
.upload-result-box {
    margin-top: 15px;
    display: none;
    animation: fadeIn 0.3s ease-in-out;
}
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(-5px); }
    to { opacity: 1; transform: translateY(0); }
}
.pagination {
    margin-top: 15px;
    display: flex;
    align-items: center;
    gap: 15px;
    justify-content: center;
}
.pagination button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}
#userSearchInput {
    padding: 6px 8px;
    border: 1px solid #ccc;
    border-radius: 4px;
    min-width: 200px;
}
.account-selector {
    display: flex;
    gap: 20px;
    margin-bottom: 5px;
    align-items: center;
}
.radio-label {
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 5px;
    font-weight: 600;
}
</style>
</head>
<body>
<div id="toast-container"></div>
<div class="container">
    <header class="app-header">
        <div class="header-brand">
             <div class="brand-icon">üí∞</div>
             <h1>–§–∏–Ω–∞–Ω—Å—ã –ñ–ö–•</h1>
        </div>
        <div class="header-profile">
            <div class="admin-info">
                <span id="financierName" style="font-weight:600;">–§–∏–Ω–∞–Ω—Å–∏—Å—Ç</span>
                <span class="role-badge financier">–§–∏–Ω–∞–Ω—Å–∏—Å—Ç</span>
            </div>
            <button class="logout-btn">–í—ã–π—Ç–∏</button>
        </div>
    </header>

    <div class="nav-tabs-container">
        <div class="tabs">
            <button class="tab-btn active" data-tab="debts">üìâ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–ª–≥–∞–º–∏</button>
            <button class="tab-btn" data-tab="users">üë• –õ–∏—á–Ω—ã–π —Å–æ—Å—Ç–∞–≤</button>
        </div>
    </div>


    <!-- TAB: IMPORT -->
    <div id="debts" class="tab-content active">
        <div class="card" style="border-left:5px solid #8e44ad">
            <h2>üìÇ –ò–º–ø–æ—Ä—Ç –∏–∑ 1–° (Excel)</h2>
            <p style="color:#666;font-size:14px;margin-bottom:15px">–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª "–û–±–æ—Ä–æ—Ç–Ω–æ-—Å–∞–ª—å–¥–æ–≤–∞—è –≤–µ–¥–æ–º–æ—Å—Ç—å" (.xlsx).<br>–°–∏—Å—Ç–µ–º–∞ –æ–±–Ω–æ–≤–∏—Ç —Å–∞–ª—å–¥–æ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Å—á–µ—Ç–∞.</p>
            <div class="upload-area">
                <div class="account-selector">
                    <span style="font-weight:bold">1. –í—ã–±–µ—Ä–∏—Ç–µ —Å—á–µ—Ç:</span>
                    <label class="radio-label"><input type="radio" name="accountType" value="209" checked> <span style="color:#27ae60">209 (–ö–æ–º–º—É–Ω–∞–ª–∫–∞)</span></label>
                    <label class="radio-label"><input type="radio" name="accountType" value="205"> <span style="color:#e67e22">205 (–ù–∞–π–º)</span></label>
                </div>
                <div class="upload-row">
                    <span style="font-weight:bold;min-width:120px">2. –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª:</span>
                    <input type="file" id="debtFile1C" accept=".xlsx,.xls" style="flex:1;padding:5px;border:1px solid #ddd;border-radius:4px">
                    <button id="btnUploadDebts" class="action-btn" style="background:#8e44ad">‚¨Ü –ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
                </div>
            </div>
            <div id="uploadResult" class="upload-result-box"></div>
        </div>
        <div class="card">
            <h3>‚ÑπÔ∏è –°–ø—Ä–∞–≤–∫–∞</h3>
            <ul style="color:#555;font-size:13px;padding-left:20px">
                <li>–§–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –§–ò–û, –î–µ–±–µ—Ç (–î–æ–ª–≥) –∏ –ö—Ä–µ–¥–∏—Ç (–ü–µ—Ä–µ–ø–ª–∞—Ç–∞).</li>
                <li>–ò–º–ø–æ—Ä—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –º–µ—Å—è—Ü–∞.</li>
                <li>–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –§–ò–û (–¥–æ–ø—É—Å–∫–∞—é—Ç—Å—è –Ω–µ–±–æ–ª—å—à–∏–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è).</li>
            </ul>
        </div>
    </div>

    <!-- TAB: USERS -->
    <div id="users" class="tab-content">
        <div class="card">
            <div class="card-header">
                <h2>–°–ø–∏—Å–æ–∫ –∂–∏–ª—å—Ü–æ–≤</h2>
                <div style="display:flex;gap:10px;align-items:center">
                    <input type="text" id="userSearchInput" placeholder="–ü–æ–∏—Å–∫ –ø–æ –§–ò–û...">
                    <button id="btnRefreshUsers" class="icon-btn refresh">‚Üª</button>
                </div>
            </div>
            <div class="table-responsive">
                <table>
                    <thead>
                        <tr>
                            <th style="width:50px">ID</th>
                            <th>–§–ò–û (–õ–æ–≥–∏–Ω)</th>
                            <th>–û–±—â.</th>
                            <th style="color:#c0392b;border-left:2px solid #eee">–î–æ–ª–≥ 209</th>
                            <th style="color:#27ae60">–ü–µ—Ä–µ–ø–ª. 209</th>
                            <th style="color:#d35400;border-left:2px solid #eee">–î–æ–ª–≥ 205</th>
                            <th style="color:#27ae60">–ü–µ—Ä–µ–ø–ª. 205</th>
                            <th>–ò—Ç–æ–≥ —Ç–µ–∫.</th>
                            <th style="text-align:right">–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="usersTableBody">
                        <tr><td colspan="9" style="text-align:center;padding:20px;color:#888">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</td></tr>
                    </tbody>
                </table>
            </div>
            <div class="pagination">
                <button id="btnPrevPage" class="page-btn" disabled>‚Üê –ù–∞–∑–∞–¥</button>
                <span id="pageInfo">–°—Ç—Ä–∞–Ω–∏—Ü–∞ 1</span>
                <button id="btnNextPage" class="page-btn">–í–ø–µ—Ä–µ–¥ ‚Üí</button>
            </div>
        </div>
    </div>
</div>

<script type="module">
import {Auth} from './js/core/auth.js';
import {FinancierApp} from './js/modules/financier.js';

if(!Auth.isAuthenticated()){
    window.location.replace('login.html');
}

// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —à–∞–ø–∫–µ
const username = Auth.getUsername();
const nameEl = document.getElementById('financierName');
if(nameEl) { nameEl.textContent = `–§–∏–Ω–∞–Ω—Å–∏—Å—Ç: ${username || ''}`; }

// –í–µ—à–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞ –≤—ã—Ö–æ–¥
const logoutBtn = document.querySelector('.logout-btn');
if(logoutBtn) { logoutBtn.addEventListener('click', () => Auth.logout()); }

// –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–∞–±–æ–≤
const tabs = document.querySelectorAll('.tab-btn');
const contents = document.querySelectorAll('.tab-content');
tabs.forEach(btn => {
    btn.addEventListener('click', () => {
        tabs.forEach(t => t.classList.remove('active'));
        contents.forEach(c => c.classList.remove('active'));
        btn.classList.add('active');
        const tabId = btn.dataset.tab;
        const tabContent = document.getElementById(tabId);
        if(tabContent) tabContent.classList.add('active');
    });
});

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
document.addEventListener('DOMContentLoaded', () => FinancierApp.init());
</script>
</body>
</html>
